:{
:script scripts/BootTidal.hs
:}

-- demo1: boxtrain

let boxtrain = do {
      let fcConstant = (frameCount/5)
          spd = (sin (fcConstant*0.00000000016))
          xshift = (sin (fcConstant*0.0001))*2
          box' x = do
            -- line (20*fcConstant) 2 40 500
            rotateY $ (fcConstant * x)*0.0001
            -- rotate (makeTidalParam "cps")
            rotate $ (fcConstant ** 2 * x)*0.000005
            rotateZ $ (fcConstant * x)*0.00001
            rotateX $ (fcConstant * x)*0.001
            translate xshift (90) blank
            -- translate (xshift/8) ((2 *) $ sin (fcConstant*0.0005)) blank
            -- rect 200 0 200 200
            box 200 0 200 200 blank
            circle 0 ((frameCount**0.3 + frameCount*0.2)/200) 100
            -- torus 200 20 200
        -- rotate cps'
          boxes = [box' x | x <- fmap makeValue [1..3]]
      in listEnumToFunc boxes }
    b2 = do
      boxtrain
      box 200 0 200 200 blank
      translate (-200) (30) 100
      rotateZ 20
in draw $ do
  translate (500) (-00) (-800)
  rotateX (200)
  rotateZ (200)
  listEnumToFunc (take 8 $ cycle [b2])


let pat = "[0 5 0 5 <8 8 8 8 8 8 8 3*3> 0 5 0]"
in do
  d1 $ linger 0.5 $ fast 2 $ slice 83 pat $ "breaks157"
      # shape 0.3
      # distort 0.1

let be
begin' = makeTidalParam "begin"

let k x = do
        translate x 0 0
        translate (-900 + 50) (000) blank
        listEnumToFunc [genRect (x/9) | x <- map makeValue [0..9]]
in draw $ do
  k 200
  k 23
  -- k 4
  -- k 4
  -- k 6
  -- k 8
  -- -- consoleLog $ (2 * gain')
  -- -- rect 20 20 20 (20)
  -- translate (-900) (000) blank
  -- listEnumToFunc [genRect (x/9) | x <- map makeValue [0..9]]
  -- -- genRect


genRect dx = do
  translate (200 * cont) (20*cont) (200 * cont)
  rect 20 20 20 (20)
    where cont = begin' + dx
